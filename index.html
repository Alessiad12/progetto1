<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Wanderlust - Profilo</title>
  <link rel="stylesheet" href="css/style_index.css">
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>
  <!-- Icona circolare in alto a destra -->
  <div class="profile-toggle" onclick="toggleProfileContainer()">
    <img src="immagini/sfondo.jpg" alt="Foto Profilo" class="profile-icon">
  </div>

  <!-- Contenitore del profilo -->
  <div class="profile-container">
    <div class="profile-header">
      <div class="profile-pic-container">
        <img src="immagini/sfondo.jpg" alt="Foto Profilo" class="profile-pic">
      </div>
      <div class="profile-info">
        <h1 class="profile-name">Mario Rossi, 35</h1>
        <p class="profile-bio">
          Appassionato di esperienze uniche e avventure.<br>
          Amo scoprire nuove culture, cibi e paesaggi: ogni viaggio è un’opportunità per crescere e condividere.
        </p>
        
        <!-- Modifica del profilo, usiamo <a> al posto di <button> -->
          <button class="modifica-toggle" onclick="caricaModificaProfilo()">Modifica profilo</button>
        
        <button class="companions-toggle">Mostra Compagni di viaggio</button>
        <button class="viaggi-toggle">Mostra viaggi</button>
      </div>
    </div>
  </div>


  <script>
    // Funzione per mostrare/nascondere il contenitore del profilo
    function toggleProfileContainer() {
      const container = document.querySelector('.profile-container');
      container.classList.toggle('active'); // Usa 'active' per mostrare/nascondere
    }

    // Chiudi il menu se clicchi fuori dal contenitore
    window.onclick = function(event) {
      if (!event.target.matches('.profile-toggle')) {
        const container = document.querySelector('.profile-container');
        if (container.classList.contains('active')) {
          container.classList.remove('active'); // Usa 'active' per chiudere il menu
        }
      }
    }

    function caricaModificaProfilo() {
      window.location.href = 'modificaprofilo.html';
    }

    // Caricamento delle informazioni del profilo all'avvio della pagina
    document.addEventListener('DOMContentLoaded', () => {
      fetch('profilo.php')
        .then(response => response.json())
        .then(data => {
          if (!data.error) {
            document.querySelector('.profile-name').textContent = `${data.nome}, ${data.eta}`;
            document.querySelector('.profile-bio').innerHTML = data.bio.replace(/\n/g, '<br>');
            document.querySelector('.profile-container').style.backgroundColor = data.colore_sfondo;
          } else {
            console.error(data.error);
          }
        })
        .catch(error => console.error('Errore:', error));
    });

    async function caricaViaggi() {
      const r = await fetch("/api/get_trips.php");
      if (!r.ok) { alert("Non loggato"); return; }

      const photos = await r.json();
      const gallery = document.getElementById("gallery");
      gallery.innerHTML = "";

      if (photos.length === 0) {
        gallery.innerHTML = '<p class="col-span-2 text-center text-navy/60">Nessun viaggio ancora.</p>';
        return;
      }

      photos.forEach((url) => {
        const img = document.createElement("img");
        img.src = url;
        img.alt = "Foto viaggio";
        img.className = "w-full h-40 object-cover rounded-lg border border-navy/30 shadow";
        gallery.appendChild(img);
      });
}

  </script>
</body>
</html>
